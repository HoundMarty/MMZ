## Signály z více senzorů a jejich zpracování

### Teoretické

1. Lineární modely šíření signálů v prostoru: definice a účel a popis ve frekvenční oblasti.
2. Vícekanálový filtr: definice a popis v časové a frekvenční oblasti.
3. Přenosová funkce vícekanálového filtru v prostředí bez odrazů.
4. Delay-and-sum beamformer: definice a vlastnosti.
5. MVDR beamformer: definice a princip.
6. Optimální vícekanálový filtr ve smyslu kvadratické vzdálenosti: princip a definice.

----

## **Sígnály z více senzorů**

Šíření signálů

![Šíření signálů](2023-05-16-14-23-24.png)

**Vícekanálové signály**

Použití více senzorů: signály pozorujeme neje v čase ale i v prostoru.

Předpokládáme $m$ senzorů.

$\textbf{p}_i$ nechť oznařuje polohu $i$ tého senzoru (vektor souřadnic)

Přepokládáme, že signály ze senzorů vzorkujeme synchronně.

Aplikace:
+ lokalizace zdroje
+ identifikace systému
+ separace signálů
+ zlepšování signálů
+ dekonvoluce (dereverberace)

**Signál z více senzorů - vektorový zápis**

Vzorek signálu (v časové oblasti)

$$
\begin{equation}
     \textbf{x}[n] = 
        \begin{bmatrix}
            x_1[n] \\
            \vdots \\
            x_m[n]
        \end{bmatrix}
\end{equation}
$$

kde $x_i[n]$ je vzorek signálu z $i$ tého senzoru, $m$ je počet senzorů.

Ve frekvenční oblasti

$$
\begin{equation}
     \textbf{X}[\theta] = 
        \begin{bmatrix}
            X_1[\theta] \\
            \vdots \\
            X_m[\theta]
        \end{bmatrix}
\end{equation}
$$

kde $\theta$ je frekvence.

## **Lineární modely šíření signálů**

+ Platí princip superpozice.

**Model bez zpoždění a odrazů**

Model předpokládá okamžité šíření signálů bez odrazů a aditivní šum

$$
\begin{equation}
     \textbf{x}[n] = \textbf{As}[n] + \textbf{v}[n]
\end{equation}
$$

+ $\textbf{s}[n]$ má $d$ složek, takzvané zdrojové nebo též "originální" signály $s_1[n],\dots,s_d[n]$.
+ $\textbf{A}$ je matice $m \times d$
+ $\textbf{v}[n]$ má rozměr jako $\textbf{x}[n]$ a obsahuje signály, které nazýváme šum.
+ ve frekvenční oblasti

$$
\begin{equation}
    \textbf{X}(\theta) = \textbf{AS}(\theta) + \textbf{V}[\theta]     
\end{equation}
$$

**Příklad: EEG a EKG záznamy**

+ Typický vzorkovací frekvence je do 2kHz.
+ Rychlost šíření signálu: rychlost světla.
+ Odrazy a zpoždění tedy můžeme zanedbat a modelovat signály pomocí okamžitého modelu.
    + (pozn.) Projevuje se pouze útlum a signály z různých zdrojů se míchají
+ Neznáme ovšem přesné skutečnosti o signálech $\textbf{s}[n]$

**Příklad: jeden signál** $s_1[n]$

Nechť $d = 1$, tedy pozorujeme jen jeden signál.

$\textbf{A}$ má pouze jeden sloupec, který značíme $\textbf{a}$ (steering vector)

Platí

$$
\begin{equation}
    \textbf{x}[n] = \textbf{a}s[n] + \textbf{v}[n]
\end{equation}
$$

ve frekvenční oblasti

$$
\begin{equation}
    \textbf{X}(\theta) = \textbf{a}S(\theta) + \textbf{V}(\theta)
\end{equation}
$$

+ **zde je $\textbf{a}$ nezávislé na $\theta$**

## **Model s jedním zpožděným signálem bez odrazů**

Model zpožděného signálu s aditivním šumem 

(pozn.) v časové oblasti nelze zapsat vektorově

$$
\begin{equation}
     x_i[n] = a_is[n-D_i] + v_i[n]
\end{equation}
$$

tedy $D_i$ je zpozdění signálu $s[n]$ na $i$ tém senzoru.

Tento model jodpovídá signálu $s[n]$, které se šíří ideálním prostředním konečnou rychlostí a bez odrazů.

Šíří-li se signál jako rovinna vlna, zpoždění $D_i$ jsou funkcí směru šíření:

$$
\begin{equation}
     D_i = \frac{\textbf{u}^T\textbf{p}_i}{c} + \text{const}.
\end{equation}
$$

kde $\textbf{u} = \left[-\sin \vartheta \cos \phi, -\sin \vartheta \sin \phi, -\cos \vartheta \ \right]^T$ je jednotkový směrový vektor určený azimutem $\vartheta$ a elevací $\phi$ a $c$ je rychlost šíření signálu.

(pozn. vytvořil @Martin Motejlek) Pomocí img k pochopení úhlů ve vzorci  $\textbf{u} = \left[-\sin \vartheta \cos \phi, -\sin \vartheta \sin \phi, -\cos \vartheta \ \right]^T$

![Azimuth a Elevace - směr signálu](2023-05-16-19-49-46.png)

**Popis ve frekvenční oblasti**

Ve frekvenční oblasti

$$
\begin{equation}
     X_i(\theta) = a_i e^{-i \theta D_i} S(\theta) + V_i(\theta)
\end{equation}
$$

Vektorový zápis

$$
\begin{equation}
     X(\theta) = b(\theta) S(\theta) + V(\theta)
\end{equation}
$$

kde 

$$
\begin{equation}
     \textbf{b}[\theta] = 
        \begin{bmatrix}
            a_1 e^{-i\theta D_1} \\
            \vdots \\
            a_m e^{-i\theta D_m}
        \end{bmatrix}
\end{equation}
$$

Vektor $\textbf{b}$ je závislý na $\theta$

## **Model zpožděného signálu: příklady**

+ Odhad směru příchodu signálu
+ Lokalizace
+ Radar, sonar $\dots$

## **Konvolutorní model: s odrazy**

Kovolutorní model s aditivním šumem

$$
     x_i[n] = \sum_{k=1}^{d} \lbrace a_{i, k} \ast s_k \rbrace[n] + v_i[n]   
$$

Jinými slovy $k$ tý signál doputuje na $i$ tý senzor zfiltrovaný filtrem $a_{i,k}$ (odrazy, zpoždění, atp.)

Ve frekvenční oblasti

$$
\begin{equation}
     X_i(\theta) = \sum_{k=1}^{d}  A_{i, k}(\theta) S_k(\theta) + V_i(\theta)
\end{equation}
$$

Vektorový zápis

$$
\begin{equation}
    \textbf{X}(\theta) =  \textbf{A}_{i, k}(\theta) \textbf{S}(\theta) + \textbf{V}(\theta)
\end{equation}
$$

kde $\textbf{A}(\theta)$ je matice jejíž $ik$ tý prvek je $A_{i,k}(\theta)$

Váhoda popisu ve frekvenční oblasti: soustava nezávislých modelů (pro každou frekvenci jeden)

## **Konvolutorní vs. model bez odrazů a zpoždění**

Model bez odrazů a zpoždění ve frekvenční oblasti

$$
\begin{equation}
    \textbf{X}(\theta) =  \textbf{AS}(\theta) + \textbf{V}(\theta)
\end{equation}
$$

Konvolutorní model ve frekvenční oblasti

$$
\begin{equation}
    \textbf{X}(\theta) =  \textbf{A}(\theta) \textbf{S}(\theta) + \textbf{V}(\theta)
\end{equation}
$$

+ Rozdíl: $\textbf{A}$ je/není závislá na frekvenci $\theta$

Příkladem konvolutorního modelu jsou akustické záznamy.

## **Zpracování vícekanálových záznamů filtry**

![Model](2023-05-16-20-08-55.png)

**MISO filtr (Multi-input single-output)**

![MISO model](2023-05-16-20-10-25.png)

Nazýváme též *Filter-and-sum beamformer*

(pozn.) Beamformer je vícekanálový filtr

Výstupem je 

$$
\begin{equation}
     y[n] = h_1 \ast x_1[n] + \dots + h_m \ast x_m[n]
\end{equation}
$$

**MISO filtr (Multi-input single-output)**

![MISO poznámka](2023-05-16-20-30-52.png)

+ Je to LTI systém.
+ Srovnejte se situací, kdy máme jen jeden senzor:
    + Pozorujeme na něm právě jeden signál $x[n]$ a můžeme se rovnou ptát co s ním provede zpracování filtrem.
+ Máme-li více senzorů záleží nejde na filtrech $h_1, \dots, h_m$, ale i na tom jaké jsou souvislosti mezi signály, které pozorujeme na senzorech.
+ (pozn.) Filtr může těchto souvistlostí využívat, aby byl získán požadovaný výstup.
+ Jinými slovy: 
    + Charakteristiku MISO filtru je nutno definovat spolu s předpokládaným modelem signálu
    + (pozn.) K charakteristice je nutno uvést, jaký je předpokládaný model.
    + (pozn.) Navržený filtr předpokládá určitý model signálu, aby správně fungoval

**MISO filtr**

Výstup v časové oblasti

$$
\begin{equation}
     y[n] = \sum_{i=1}^{m}\left\lbrace h_i \ast x_i \right\rbrace[n]
\end{equation}
$$

(pozn.) $m =$ počet senzorů

ve frekvenční oblasti

$$
\begin{equation}
     Y(\theta) = \sum_{i=1}^{m} H_i(\theta)X_i(\theta)
\end{equation}
$$

a vektorově

$$
\begin{equation}
     \textbf{Y}(\theta) = \textbf{H}(\theta)^T \textbf{X}(\theta)
\end{equation}
$$

kde $\textbf{H}(\theta) = \left\[ H_1(\theta), \dots, H_m(\theta) \right\]^T$

## **Charakteristika MISO filtru**

Předpoklad:
+ signál je rovinná harmonická vlna o frekvenci $\theta$ přicházející z nekonečna ve směru normálového vektoru $\textbf{u}$ rychlostí $c$ m/s a šíří se bez odrazů.

![Charakteristická funkce](2023-05-16-20-58-49.png)

(pozn.)

Původní signál na každý vstup dochází se spožděním $e^{-i\theta M_k}$

Signál z každého vstupu je zpracován filtrem $H_k(\theta)$

Pak se všechny výstupu sečtou $\rightarrow$ výstup MISO filtru

$\Psi$ zahrnuje všechny tyto kroky oddělující původní signál od výsledného

